# FastQC and Salmon Analysis Pipeline

![FastQC Logo](https://raw.githubusercontent.com/s-andrews/FastQC/master/src/main/resources/uk/ac/babraham/FastQC/Resources/fastqc_icon.png)

## Table of Contents

- [Overview](#overview)
- [Project Structure](#project-structure)
- [Requirements](#requirements)
- [Scripts](#scripts)
  - [1. FastQC Analysis](#1-fastqc-analysis)
  - [2. Salmon Quantification](#2-salmon-quantification)
- [Usage](#usage)
- [Output](#output)
- [Troubleshooting](#troubleshooting)
- [Contributing](#contributing)
- [License](#license)
- [Contact](#contact)

## Overview

This project contains two main scripts for analyzing RNA-seq data:
1. A FastQC analysis script for quality control of BAM files
2. A Salmon quantification pipeline for transcript quantification

These scripts are designed to work with the masood_colon_300 project data structure and are optimized for execution on a SLURM-managed high-performance computing environment.

## Project Structure

```
project/
│
├── fastqc-script.sh              # Script for FastQC analysis
├── run_fastqc.sh                 # Script for Salmon quantification (misnamed)
├── fastqc_output/                # Output directory for FastQC results
├── salmon_output/                # Output directory for Salmon results
├── samples.txt                   # Sample sheet generated by Salmon script
├── generate_count_matrix.R       # R script for generating count matrix
├── gene_count_matrix.csv         # Output: gene-level count matrix
├── gene_tpm_matrix.csv           # Output: gene-level TPM matrix
└── README.md                     # This file
```

## Requirements

- SLURM workload manager
- Conda (with a 'spatial' environment containing FastQC)
- Salmon
- R (with tximport, readr, and dplyr packages)
- gffread (for generating transcriptome file)

## Scripts

### 1. FastQC Analysis

**Script name:** `fastqc-script.sh`

**Purpose:** This script runs FastQC on BAM files to perform quality control analysis.

**When to use:** Use this script as the first step in your analysis pipeline to assess the quality of your sequencing data. It should be run before any further processing or analysis of the RNA-seq data.

**Key features:**
- Processes all RNA folders in the project directory
- Runs FastQC on sorted BAM files
- Outputs results in sample-specific directories
- Utilizes multiple CPU cores for faster processing

### 2. Salmon Quantification

**Script name:** `run_fastqc.sh` (Note: This script is misnamed and actually performs Salmon quantification)

**Purpose:** This script performs transcript quantification using Salmon and generates gene-level count and TPM matrices.

**When to use:** Use this script after running the FastQC analysis and ensuring that your sequencing data is of good quality. This script will quantify gene expression levels, which is typically the next step in an RNA-seq analysis pipeline.

**Key features:**
- Generates a transcriptome file if not present
- Creates a Salmon index
- Runs Salmon quantification on all samples
- Creates a sample sheet
- Generates gene-level count and TPM matrices using R

## Usage

To run the FastQC analysis:

```bash
sbatch fastqc-script.sh
```

To run the Salmon quantification pipeline:

```bash
sbatch run_fastqc.sh
```

Note: Ensure that all required modules and data files are available before running the scripts.

## Output

### FastQC Analysis
- FastQC HTML reports and ZIP files for each sample in `fastqc_output/`

### Salmon Quantification
- Salmon quantification results for each sample in `salmon_output/`
- `samples.txt`: A sample sheet listing all processed samples
- `gene_count_matrix.csv`: A gene-level count matrix
- `gene_tpm_matrix.csv`: A gene-level TPM (Transcripts Per Million) matrix

## Troubleshooting

If you encounter any issues:

1. Check the error and output files generated by SLURM (`*.error` and `*.out`)
2. Verify that all required modules are loaded and software is installed
3. Ensure input files and directories exist and have correct permissions
4. Check the log files generated by the scripts for specific error messages

## Contributing

Contributions to improve the analysis pipeline are welcome. Please fork the repository and submit a pull request with your proposed changes.

## License

This project is licensed under the MIT License - see the [LICENSE.md](LICENSE.md) file for details.

## Contact

For any queries regarding this analysis pipeline, please contact:

**Ateeq Khaliq**  
Email: akhaliq@iu.edu

---

<p align="center">Created with ❤️ by Ateeq Khaliq</p>
